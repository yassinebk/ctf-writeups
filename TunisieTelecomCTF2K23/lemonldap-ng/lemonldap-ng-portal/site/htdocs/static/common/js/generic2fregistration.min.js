!function(){var t=function(e,r){return $("#msg").attr("trspan",e),$("#msg").html(window.translate(e)),$("#color").removeClass("message-positive message-warning message-danger alert-success alert-warning alert-danger"),$("#color").addClass("message-"+r),"positive"===r&&(r="success"),$("#color").addClass("alert-"+r),$("#msg").attr("role","danger"===r?"alert":"status")},s=function(e,r,n){if(console.log("Error",n),(n=JSON.parse(e.responseText))&&n.error)return n=n.error.replace(/.* /,""),console.log("Returned error",n),t(n,"warning")},e=function(){var e=$("#generic").val(),r=window.datas.prefix;return e?$.ajax({type:"POST",url:portal+"/2fregisters/"+r+"/sendcode",dataType:"json",data:{generic:e},error:s,success:function(e){return e.error?e.error.match(/PE79/)?t(e.error,"warning"):t(e.error,"danger"):($("#token").val(e.token),t("genericCheckCode","success"))}}):(t("PE79","warning"),$("#generic").focus())},r=function(){var e=$("#generic").val(),r=$("#genericname").val(),n=$("#code").val(),a=window.datas.prefix,o=$("#token").val();return e?$.ajax({type:"POST",url:portal+"/2fregisters/"+a+"/verify",dataType:"json",data:{generic:e,genericname:r,genericcode:n,token:o},error:s,success:function(e){return e.error?e.error.match(/mailNotSent/)?t(e.error,"warning"):t(e.error,"danger"):($(document).trigger("mfaAdded",[{type:a}]),t("genericRegistered","success"))}}):(t("PE79","warning"),$("#generic").focus())};$(document).ready(function(){return $("#verify").on("click",e),$("#register").on("click",r)})}.call(this);